{"changed":true,"filter":false,"title":"shots_controller.rb","tooltip":"/app/controllers/shots_controller.rb","value":"class ShotsController < ApplicationController\n  before_action :set_shot, only: [:show, :edit, :update, :destroy, :like, :unlike]\n  before_action :authenticate_user!, only: [:edit, :update, :destroy, :like, :unlike]\n  impressionist actions: [:show], unique: [:impressionable_type, :impressionable_id, :session_hash]\n\n  # GET /shots\n  # GET /shots.json\n  def index\n    @shots = Shot.all.order('created_at DESC')\n    # pagenation\n    @shots = Shot.page(params[:page]).per(12)\n  end\n\n  # GET /shots/1\n  # GET /shots/1.json\n  def show\n  end\n\n  # GET /shots/new\n  def new\n    @shot = current_user.shots.build\n  end\n\n  # GET /shots/1/edit\n  def edit\n  end\n\n  # POST /shots\n  # POST /shots.json\n  def create\n    @shot = current_user.shots.build(shot_params)\n\n    respond_to do |format|\n      if @shot.save\n        format.html { redirect_to @shot, notice: 'Shot was successfully created.' }\n        format.json { render :show, status: :created, location: @shot }\n      else\n        format.html { render :new }\n        format.json { render json: @shot.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PATCH/PUT /shots/1\n  # PATCH/PUT /shots/1.json\n  def update\n    respond_to do |format|\n      if @shot.update(shot_params)\n        format.html { redirect_to @shot, notice: 'Shot was successfully updated.' }\n        format.json { render :show, status: :ok, location: @shot }\n      else\n        format.html { render :edit }\n        format.json { render json: @shot.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /shots/1\n  # DELETE /shots/1.json\n  def destroy\n    @shot.destroy\n    respond_to do |format|\n      format.html { redirect_to shots_url, notice: 'Shot was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  def like\n    @shot.liked_by current_user\n    respond_to do |format|\n      format.html { redirect_back fallback_location: root_path }\n      format.json { render layout:false }\n    end\n  end\n\n  def unlike\n    @shot.unliked_by current_user\n    respond_to do |format|\n      format.html { redirect_back fallback_location: root_path }\n      format.json { render layout:false }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_shot\n      @shot = Shot.find(params[:id])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def shot_params\n      params.require(:shot).permit(:title, :description, :user_shot)\n    end\nend","undoManager":{"mark":3,"position":-1,"stack":[[{"start":{"row":8,"column":32},"end":{"row":8,"column":33},"action":"insert","lines":["A"],"id":10}],[{"start":{"row":8,"column":33},"end":{"row":8,"column":34},"action":"remove","lines":["E"],"id":10},{"start":{"row":8,"column":32},"end":{"row":8,"column":33},"action":"remove","lines":["D"]}],[{"start":{"row":8,"column":29},"end":{"row":8,"column":30},"action":"insert","lines":["i"],"id":11},{"start":{"row":8,"column":30},"end":{"row":8,"column":31},"action":"insert","lines":["d"]}],[{"start":{"row":8,"column":38},"end":{"row":8,"column":39},"action":"remove","lines":["t"],"id":12},{"start":{"row":8,"column":37},"end":{"row":8,"column":38},"action":"remove","lines":["a"]},{"start":{"row":8,"column":36},"end":{"row":8,"column":37},"action":"remove","lines":["_"]},{"start":{"row":8,"column":35},"end":{"row":8,"column":36},"action":"remove","lines":["d"]},{"start":{"row":8,"column":34},"end":{"row":8,"column":35},"action":"remove","lines":["e"]},{"start":{"row":8,"column":33},"end":{"row":8,"column":34},"action":"remove","lines":["t"]},{"start":{"row":8,"column":32},"end":{"row":8,"column":33},"action":"remove","lines":["a"]},{"start":{"row":8,"column":31},"end":{"row":8,"column":32},"action":"remove","lines":["e"]},{"start":{"row":8,"column":30},"end":{"row":8,"column":31},"action":"remove","lines":["r"]},{"start":{"row":8,"column":29},"end":{"row":8,"column":30},"action":"remove","lines":["c"]}]]},"ace":{"folds":[],"scrolltop":1162.5,"scrollleft":0,"selection":{"start":{"row":16,"column":5},"end":{"row":16,"column":5},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":71,"state":"start","mode":"ace/mode/ruby"}},"timestamp":1586038886691}